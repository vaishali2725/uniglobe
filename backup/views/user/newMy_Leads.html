
<div ng-hide="hide_leads">
<div class="row">
<div class="col-md-12">
<div class="portlet-title" style="margin-bottom: 15px;">
<div class="caption">
<i class="icon-bar-chart font-green-sharp hide"></i>
<span class="caption-subject font-green-sharp bold uppercase">Pending Leads</span>
</div>
</div>
<div class="portlet light portlet-fit bordered">
<div class="portlet-body">
<table class="table table-striped table-hover table-bordered" id="sample_editable_1">
<thead>
<tr>
<th> Full Name </th>
<th> Email </th>
<th> Contact </th>
<th> Status</th>
<th> View </th>
</tr>
</thead>                            
<tbody>
<tr ng-repeat="lead in myLeads">
<td>{{lead.clientName}}</td>
<td>{{lead.email}} </td>
<td>{{lead.phone}} </td>
<td>{{lead.status}}</td>
<td><button type="button" class="todo-username-btn btn btn-circle btn-default btn-sm" ng-click="viewLead(lead.leadid)">&nbsp;View&nbsp;</button></span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>

<div ng-show="show_lead_info">
<div class="row" style="margin-bottom:30px;">

<div class="col-md-5" style="margin-bottom:20px;">
<td><button type="button" style="background-color:#3598dc;color:white;" class="todo-username-btn btn btn-circle btn-default btn-sm" ng-click="showleads()">&nbsp;Show Leads&nbsp;</button></span></td>
</div>
<div class="col-md-12">
<div class="col-md-5">
<div class="tab-pane active" id="tab_3">
<div class="portlet box blue">
<div class="portlet-title">
<div class="caption">
<i class="fa fa-gift"></i>Leads Details </div>
<div class="tools">
<a href="javascript:;" class="collapse" data-original-title="" title=""> </a>
<a href="#portlet-config" data-toggle="modal" class="config" data-original-title="" title=""> </a>
<a href="javascript:;" class="reload" data-original-title="" title=""> </a>                                  
</div>
</div>
<div class="portlet-body form">
<div class="form-body" ng-repeat="led in data.leadDetails">
<h2 class="margin-bottom-20"> Client Name : {{led.clientName}} </h2>
<h3 class="form-section">Contact Details</h3>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Email :</label>
<div class="col-md-3">
<p class="form-control-static"> {{led.email}} </p>
</div>
</div>
</div>

<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Alternative E-mail:</label>
<div class="col-md-9">
<p class="form-control-static"> {{led.altemail}} </p>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Contact No.:</label>
<div class="col-md-9">
<p class="form-control-static">{{led.phone}} </p>
</div>
</div>
</div>
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Alternative Contact no.:</label>
<div class="col-md-9">
<p class="form-control-static"> {{led.altphone}}</p>
</div>
</div>
</div>
</div>
<!--/row-->
<div class="row">
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">City : </label>
<div class="col-md-9">
<p class="form-control-static">{{led.city}}</p>
</div>
</div>
</div>

<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Country:</label>
<div class="col-md-9">
<p class="form-control-static"> {{led.country}}</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>	


<div class="col-md-7">


<div class="action-form" >
<form name="actionForm" ng-submit="addAction()" >
<div class="form-group" ng-class="{ 'has-error' : actionForm.status.$invalid && !actionForm.status.$pristine }">
<label>Status</label>
<div class="input-icon right">
<select class="form-control input-circle" id="status" name="status" ng-model="action.status" onchange="checkStatus()" required>
<option value="">Select Status</option>
 <option value="Reject">Reject</option>
 <option value="Not Intrested">Not Intrested</option>
 <option value="No Responce">No Responce</option>
 <option value="Call Back">Call Back</option>
 <option value="Intrested">Intrested</option>
</select>
<p ng-show="actionForm.status.$invalid && !actionForm.status.$pristine" class="help-block">Please select status</p> 
</div>
</div>
<input type="text" name="leadid" ng-model="action.leadid" >

<div class="form-group" ng-class="{ 'has-error' : actionForm.action_dec.$invalid && !actionForm.action_dec.$pristine }">
<label>Description</label>
<div class="input-icon right">
  <textarea class="form-control" ng-model="action.action_des" name="action_dec" rows="3" required></textarea>
  <p ng-show="actionForm.action_dec.$invalid && !actionForm.action_dec.$pristine" class="help-block">Description is required</p>
</div>
</div>
<div id="reminder">
<div class="form-group">
<div class="col-md-6">
<div class="input-group date form_datetime">
 <input type="text" id="datepicker" ng-model="action.appointmentDate" name="appointmentDate" readonly class="form-control">
 <span class="input-group-btn">
   <button class="btn default date-set" type="button">
      <i class="fa fa-calendar"></i>
   </button>
 </span>
</div>
</div>
</div>
<div class="form-group">
<div class="col-md-6">
<div class="input-icon">
<input type="text" id="time" ng-model="action.appointmentTime" name="appointmentTime"   class="form-control" readonly> </div>
  </div>
</div>
</div>





<input class="btn btn-circle btn-md btn-default" type="submit" ng-model="$scope.action.submit" value="submit">
<button class="btn btn-circle cancelbtn btn-md btn-default" >Cancel</button>

</form>
</div>


<div class="portlet-body" style="margin-top:30px;">
<table class="table table-striped table-bordered table-advance table-hover">
<thead>
<tr>
<th>Call No.</th>
<th><i class="fa fa-briefcase"></i> Status</th>
<th class="hidden-xs"><i class="fa fa-question"></i> Descrition </th>
<th><i class="fa fa-bookmark"></i> Time </th>
</tr>
</thead>
<tbody>
<tr ng-repeat="action in data.action">
<td><a href="javascript:;">{{action.actionid}}</a></td>
<td class="hidden-xs"> {{action.status}}<span class="label label-success label-sm"> Paid </span> </td>
<td> {{action.action_des}}</td>
<td>{{action.time}}</td>
</tr>
</tbody>
</table>
</div>

</div> 

</div>
</div>  
</div>
<style type="text/css">
#reminder{
display : none;
margin-bottom: 75px;
}
</style>




<script>
function checkStatus() { 
var status = document.getElementById("status");
var selectedStatus = status.options[status.selectedIndex].value;
if(selectedStatus == "Call Back"){
jQuery("#reminder").css("display", "block");
}else{
jQuery("#reminder").css("display", "none");
}
}
</script>
<script>
$(function() {
$( "#datepicker" ).datepicker();
});



(function ($) {
    var methods = {
        getTime: function (elem) {
            var time = {};
            if (elem != undefined) {
                time = elem.data();
              if (time.h == null && elem.val().length) {
                  var arr = elem.val().split(":");
                  time.h = arr[0].trim();
                  time.m = arr[1].trim().split(" ")[0];
              }
            }
            return time;
        },
        setTime: function (time) {
            this.val(defaults.format(time));
        }
    };

  $.fn.timepicker = function (options) {

    var defaults = {
      format: function (h, m, t) {
        if (settings.isAMPM) {
          return h + " : " + m + " " + t;
        } else {
          return h + " : " + m;
        }
      },
      class_name: '',
      min_hour: 1,
      max_hour: 12,
      isAMPM: true,
      hours_step: '1',
      minutes_step: '1',
      overflow: false,
      hide_mobile_keyboard: false,
      onChange: null,
      beforeSetTime: null,
      start_time: null // { h: '', m: '', t: '' }
    };

    if (methods[options]) {
        return methods[options].apply(this, Array.prototype.slice.call(arguments, 1));
    }

    var settings = $.extend({}, defaults, options);

    var _this = $(this);

    _this.wrap("<div class='timePicker'>");
    var parent = _this.parents(".timePicker");

    var topBtn = "<div class='prev action-next'></div>";
    var bottomBtn = "<div class='next action-prev'></div>";

    var popup = $("<div class='timepicker_wrap " + settings.class_name + "'>" +
                  "<div class='arrow_top'></div>" +
                  "<div class='hours'>" + topBtn +
                  "<div class='hTime'>" +
                  "<input type='text' class='timepicker-input'" + 
                  (settings.use_mobile_keyboard ? "readonly" : "") + "></div>" +
                  bottomBtn +
                  "</div>" +
                  "<div class='minutes'>" + topBtn +
                  "<div class='mTime'>" +
                  "<input type='text' class='timepicker-input'" + 
                  (settings.use_mobile_keyboard ? "readonly" : "") + "></div>" +
                  bottomBtn +
                  "</div>");

    if (settings.isAMPM) {
      popup.append("<div class='amPm'>" + topBtn +
                   "<div class='tTime'><input type='text' class='timepicker-input'" + 
                   (settings.use_mobile_keyboard ? "readonly" : "") + " readonly></div>" +
                   bottomBtn +
                   "</div>");
    }

    parent.append(popup);

    var wrap = _this.next(".timepicker_wrap");
    var wrapChildren = wrap.find("div");
    var inputs = parent.find('input');

    inputs.keydown(function (keyevent) {
      var len = $(this).val().length;

      if ($.inArray(keyevent.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
          (keyevent.keyCode == 65 && keyevent.ctrlKey === true) ||
          (keyevent.keyCode >= 35 && keyevent.keyCode <= 39)) {
        return;
      }

      if ((keyevent.shiftKey || (keyevent.keyCode < 48 || keyevent.keyCode > 57)) &&
          (keyevent.keyCode < 96 || keyevent.keyCode > 105) || len == 2) {
        keyevent.preventDefault();
      }
    });


    $(document).on("click", function (event) {
      if (!$(event.target).is(wrap) && wrap.css("display") == "block") {
        if (!$(event.target).is(_this)) {
          setValue(event, !inTimepicker($(event.target)));
        } else {
          wrap.css({
              "top": _this.position().top + _this.height()  + 10 + "px",
              "left": _this.position().left + "px"
          });
          openTimepicker();
        }
      }
    });

    _this.on('click', openTimepicker);

    inputs.on('focus', function () {
      var input = $(this);
      if (!input.is(_this)) {
        input.select();
      }
    });

    inputs.on('keydown', function (e) {
      var direction, input = $(this);

      if (e.which === 38) {
        direction = 'next';
      } else if (e.which === 40) {
        direction = 'prev';
      }

      if (input.closest('.timepicker_wrap .hours').length) {
        changeHour(null, direction);
      } else if (input.closest('.timepicker_wrap .minutes').length) {
        changeMinute(null, direction);
      } else if (input.closest('.timepicker_wrap .amPm').length && settings.show_meridian) {
        changeType(null, direction);
      }
    });

    inputs.on('blur', function () {
      setTimeout(function () {
        var focused_element = $(document.activeElement);
        if (focused_element.is(':input') && !inTimepicker(focused_element)) {
          setValue();
          closeTimepicker();
        }
      }, 0);
    });
    
    function inTimepicker(elem) {
      return $.contains(parent[0], elem[0]) || parent.is(elem);
    }
    
    function setFromPicker() {
      var hours = wrap.find(".hTime input").val();
      var minutes = wrap.find(".mTime input").val();
      var type = "";

      if (settings.isAMPM) {
        type = wrap.find(".tTime input").val();
      }

      if (hours.length !== 0 && minutes.length !== 0 && (!settings.isAMPM || type.length !== 0)) {

          if ($.isFunction(settings.beforeSetTime)) {
              time = settings.beforeSetTime.apply(_this,
                  [methods.getTime(_this), { h: hours, m: minutes, t: type }]);
              hours = time.h;
              minutes = time.m;
              type = time.t;
          }
        _this.data('h', hours);
        _this.data('m', minutes);

        if (settings.isAMPM) {
          _this.data('t', type);
          _this.val(settings.format(hours, minutes, type));
        } else {
          _this.val(settings.format(hours, minutes));
        }

        return true;
      }
      return false;
    }

    function setValue(event, close) {

      setFromPicker();

      if (settings.onChange !== null) {
        settings.onChange(_this[0]);
      }

      if (close) {
        closeTimepicker();
      }

    }

    function openTimepicker() {

      setDate(settings.start_time);
      wrap.fadeIn();

      var first = wrap.find('input:visible').first();
      first.focus();

      var first_exitHandler = function (e) {
        if (e.which === 9 && e.shiftKey) {
          first.off('keydown', first_exitHandler);
          var all_elements = $(':input:visible:not(.timepicker-input)');
          var index = all_elements.index(_this);
          var previous = all_elements.get(index - 1);
          previous.focus();
        }
      };
      first.on('keydown', first_exitHandler);
    }

    function closeTimepicker() {
      wrap.fadeOut();
    }

    function setDate(start_time) {
      var d, h, m, t;

      if (_this.data("h") != null && _this.data("m") != null && (_this.data('t') != null && settings.isAMPM == (_this.data('t').length != 0))) {
        h = Number(_this.data("h"));
        m = Number(_this.data("m"));
        if (settings.isAMPM) {
          t = _this.data("t");
        }
      }
      else if (start_time != null) {
        h = Number(start_time.h);
        m = Number(start_time.m);
        if (settings.isAMPM) {
          t = start_time.t;
        }
      }
      else {
        d = new Date();
        h = d.getHours();
        m = d.getMinutes();
        t = "AM";
        if (h > 12 && settings.isAMPM) {
          h -= 12;
          t = "PM";
        }
      }
      
      var realHours = 0;
      while (h > 59) {
          h -= 60;
          realHours++;
      } 
      
      if (realHours != 0)
          h = realHours;

      if (h < 10) {
        wrap.find(".hTime input").val("0" + h);
      } else {
        wrap.find(".hTime input").val(h);
      }
      if (m < 10) {
        wrap.find(".mTime input").val("0" + m);
      } else {
        wrap.find(".mTime input").val(m);
      }
      if (settings.isAMPM) {
        wrap.find(".tTime input").val(t);
      }
    }

    function changeHour(elem, direction) {
      var curHours = Number(wrap.find(".hours .hTime input").val());
      var min = Number(settings.min_hour);
      var max = Number(settings.max_hour);
      var step = Number(settings.hours_step);
      if ((elem && elem.hasClass('action-next')) || direction === 'next') {
        if (curHours + step > max) {
          var min_value = min;
          if (min_value < 10) {
            min_value = '0' + min_value;
          } else {
            min_value = String(min_value);
          }
          wrap.find(".hours .hTime input").val(min_value);
        } else {
          curHours += step;
          if (curHours < 10) {
            curHours = "0" + curHours;
          }
          wrap.find(".hours .hTime input").val(curHours);
        }
      } else if ((elem && elem.hasClass('action-prev')) || direction === 'prev') {
        if (curHours - step < min) {
          var max_value = max;
          if (max_value < 10) {
            max_value = '0' + max_value;
          } else {
            max_value = String(max_value);
          }
          wrap.find(".hours .hTime input").val(max_value);
        } else {
          curHours -= step;
          if (curHours < 10) {
            curHours = "0" + curHours;
          }
          wrap.find(".hours .hTime input").val(curHours);
        }
      }
    }

    function changeMinute(elem, direction) {
      var curMinute = Number(wrap.find(".minutes .mTime input").val());
      var min = 0;
      var max = 59;
      var step = Number(settings.minutes_step);
      if ((elem && elem.hasClass('action-next')) || direction === 'next') {
        if (curMinute + step > max) {
          wrap.find(".minutes .mTime input").val("00");
          if (settings.overflow_minutes) {
            changeHour(null, 'next');
          }
        } else {
          curMinute += step;
          if (curMinute < 10) {
            wrap.find(".minutes .mTime input").val("0" + curMinute);
          } else {
            wrap.find(".minutes .mTime input").val(curMinute);
          }
        }
      } else if ((elem && elem.hasClass('action-prev')) || direction === 'prev') {
        if (curMinute - step <= -1) {
          wrap.find(".minutes .mTime input").val(max + 1 - step);
          if (settings.overflow_minutes) {
            changeHour(null, 'prev');
          }
        } else {
          curMinute -= step;
          if (curMinute < 10) {
            wrap.find(".minutes .mTime input").val("0" + curMinute);
          } else {
            wrap.find(".minutes .mTime input").val(curMinute);
          }
        }
      }
    }

    function changeType(elem, direction) {
      var curType = wrap.find(".amPm .tTime input").val();
      if ((elem && elem.hasClass('action-next')) || direction === 'next') {
        if (curType == "AM") {
          wrap.find(".amPm .tTime input").val("PM");
        } else {
          wrap.find(".amPm .tTime input").val("AM");
        }
      } else if ((elem && elem.hasClass('action-prev')) || direction === 'prev') {
        if (curType == "AM") {
          wrap.find(".amPm .tTime input").val("PM");
        } else {
          wrap.find(".amPm .tTime input").val("AM");
        }
      }
    }

    var next = wrap.find(".action-next");
    var prev = wrap.find(".action-prev");
    $(prev).add(next).on("click", function () {
      var elem = $(this);
      if (elem.parent().attr("class") == "hours") {
        changeHour(elem);
      } else if (elem.parent().attr("class") == "minutes") {
        changeMinute(elem);
      } else {
        if (settings.isAMPM) {
          changeType(elem);
        }
      }
    });

    if (settings.start_time) {
      setDate(settings.start_time);
      setFromPicker();
    }
    return _this;
  };
} (jQuery));


$(function() {
   var tpOptions = {
            class_name: "pktTimePicker",
            overflow_minutes: true,
            start_time: { h: 12, m: '00', t: 'AM' },
            isAMPM: 1,
            beforeSetTime: function (oldTime, newTime) {
                var lastDefFrom = newTime.h * 60 + newTime.m;
                //setSessCookie("userStartTime", lastDefFrom);
                return newTime;
            }
        };
        
  $("#time").timepicker(tpOptions);
});

</script>
<style>
.hTime,
.mTime,
.tTime {
  width: 100%;
  text-align: center;
  margin: 10px 0;
}

.hours,
.minutes,
.amPm {
  color: #2d2e2e;
  float: none;
  font-size: 16px;
  font-family: inherit;
  width: 30px;
  font-weight: normal;
  display: inline-block;
  margin: 0px 3px;
}

.prev,
.next {
  cursor: pointer;
  border: 1px solid #ccc;
  margin: auto;
  background: url(http://joxi.ru/jnAy31oiWZ9dmZ.png) no-repeat;
  border-radius: 5px;
  background-size: 15px;
  padding: 13px;
  width: 5px;
}

.prev:hover,
.next:hover {
  background-color: #ccc;
}

.next {
  background-position: 50% 150%;
}

.prev {
  background-position: 50% -50%;
}

.time_picker {
  position: relative;
}

.timepicker_wrap {
  padding: 10px;
  border-radius: 5px;
  z-index: 998;
  display: none;
  box-shadow: 2px 2px 5px 0 rgba(50,50,50,0.35);
  border: 1px solid #ccc;
  float: left;
  position: absolute;
  top: 27px;
  left: 0;
  width: 130px;
  background: #FFFFFF;
}

.arrow_top {
  position: absolute;
  top: -10px;
  left: 20px;
  background: url(http://joxi.ru/vDr8eYjupNK9m6.png) no-repeat;
  width: 18px;
  height: 10px;
  z-index: 999;
}
input.timepicker-input {
  background: none repeat scroll 0 0 #FFFFFF;
  border: 1px solid #CCCCCC;
  float: none;
  margin: 0;
  text-align: center;
  width: 31px;
  border-radius: 0;
}
/* -------------------------------------------- */

</style>