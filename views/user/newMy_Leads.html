<style>
.leadtitle{
	float: left;
    margin-top: 7px;
}
.form-control-solid{
width:30%;
}
</style>
<div class="page-bar">
    <ul class="page-breadcrumb">
        <li><i class="fa fa-home"></i>
            <a href="#/dashboard">Home</a>
           <i class="fa fa-angle-right"></i>
        </li>
        <li>
            <a href="#">My Leads</a>
        </li>
    </ul>
  
</div>
<div ng-show="editleadform" class="my_lead_style">

<div class="col-md-12" style="margin-bottom:20px;">
<td><a href="" ng-click="show_list()"><button type="button" class="todo-username-btn btn btn-circle btn-default btn-sm" >&nbsp;Show Leads&nbsp;</button></a>
</span></td>
</div>
   <form class="form-horizontal adduserform" name="leadForm" ng-submit="updatelead(lead,l.leadid,code)"  ng-repeat="l in leadtoedit">
   <div class="form" >
 
  <div class="form-group add-user col-md-6 col-sm-6 padding-left" ng-class="{ 'has-error' : leadForm.clientName.$invalid && !leadForm.clientName.$pristine }">
   <input type="text" class="form-control" ng-model="lead.clientName" ng-init="lead.clientName=l.clientName" name="clientName" placeholder="Enter client name" required> 
   <p ng-show="leadForm.clientName.$invalid && !leadForm.clientName.$pristine" class="help-block">Client name is required</p>
  </div>
  
<div class="form-group add-user col-md-6 col-sm-6 padding-left" ng-class="{ 'has-error' : leadForm.email.$invalid && !leadForm.email.$pristine }">
<input type="email" class="form-control" ng-model="lead.email" ng-init="lead.email=l.email" id="email" name="email" placeholder="E-mail" ng-blur="checkleadavailability()"  >
<p ng-show="leadForm.email.$invalid && !leadForm.email.$pristine" class="help-block">Enter valid E-mail ID</p>
 </div>
  

 <div class="form-group add-user col-md-6 col-sm-6 padding-left" ng-class="{ 'has-error' : leadForm.altemail.$invalid && !leadForm.altemail.$pristine }">
 <input type="email" class="form-control"   ng-model="lead.altemail" ng-init="lead.altemail=l.altemail" name="altemail" placeholder="Alternative E-mail"> 
 <p ng-show="leadForm.altemail.$invalid && !leadForm.altemail.$pristine" class="help-block">Repeated Email-Please enter another email address</p>
</div>
<div class="form-group add-user col-md-6 col-sm-6 padding-left" ng-class="{ 'has-error' : leadForm.country.$invalid && !leadForm.country.$pristine }">
<select name="country" class="select2 form-control" ng-model="lead.country" ng-init="lead.country = l.country" ng-change="onchange(lead.country.mcode)"
      ng-options="country.name as country.name for country in countries"  required>
         <option value="">Select Country</option>               
</select>
<p ng-show="leadForm.country.$invalid && !leadForm.country.$pristine" class="help-block">Please select country </p>
 </div>

<div class="form-group add-user col-md-6 col-sm-6 padding-left ">
 <div class="form-group add-user col-md-3 col-sm-3">
<input type="text"  class="form-control" ng-model="code"   id="code" name="code" readonly > 
</div>
<div class="form-group add-user col-md-9 col-sm-9 padding-left" ng-class="{ 'has-error' : leadForm.phone.$invalid && !leadForm.phone.$pristine }">
<input type="text" pattern="[0-9.]+" class="form-control" ng-model="lead.phone" ng-init="lead.phone=l.phone"  id="phone" name="phone" placeholder="Mobile Number" > 
<p ng-show="leadForm.phone.$invalid && !leadForm.phone.$pristine" class="help-block">Please enter valid mobile number</p>
</div>
 </div>
 
 <div class="form-group add-user col-md-6 col-sm-6 padding-left ">
 <div class="form-group add-user col-md-3 col-sm-3">
<input type="text"  class="form-control" ng-model="code"   id="code" name="code" readonly > 
</div>
<div class="form-group add-user col-md-9 col-sm-9 padding-left" ng-class="{ 'has-error' : leadForm.altphone.$invalid && !leadForm.altphone.$pristine }">
<input type="text" pattern="[0-9.]+" class="form-control" ng-model="lead.altphone" ng-init="lead.altphone=l.altphone"  id="altphone" name="altphone" placeholder="alternate Mobile Number" > 
<p ng-show="leadForm.altphone.$invalid && !leadForm.altphone.$pristine" class="help-block">Please enter valid mobile number</p>
</div>
 </div>
 
 
  <div class="form-group add-user col-md-6 col-sm-12" ng-class="{ 'has-error' : leadForm.register_date.$invalid && !leadForm.register_date.$pristine }">
  <input type="text" id="example7" class="form-control ng-invalid ng-invalid-required ng-touched" ng-model="lead.register_date" ng-init="lead.register_date=l.register_date" name="register_date" placeholder="Select register Date" required>
 <p ng-show="leadForm.srtdate.$invalid && !leadForm.srtdate.$pristine" class="help-block">Please enter register Date </p>
  </div>

   <div class="form-group add-user col-md-6 col-sm-12" ng-class="{ 'has-error' : leadForm.ac_number.$invalid && !leadForm.ac_number.$pristine }">
  <input type="text" id="ac_number" class="form-control ng-invalid ng-invalid-required ng-touched" ng-model="lead.ac_number"  ng-init="lead.ac_number=l.ac_number" name="ac_number"  placeholder="Enter Account Number" >
 <p ng-show="leadForm.ac_number.$invalid && !leadForm.ac_number.$pristine" class="help-block">Please enter Account Number</p>
  </div>
 <div class="portlet-title col-md-12 col-sm-12 padding-left">
                        <div class="caption">
                            <i class="icon-bar-chart font-green hide"></i>
                            <span class="caption-helper"></span> &nbsp;
                            <span class="caption-subject font-green bold uppercase">More Information</span>
                        </div>
 </div>

<div class="form-group add-user col-md-6 col-sm-6 padding-left" ng-class="{ 'has-error' : leadForm.status.$invalid && !leadForm.status.$pristine }">
<select name="status" class="select2 form-control" ng-model="lead.status" ng-init="lead.status=l.status" name="status" aria-hidden="true" required>
 <option value="">Select Lead Status</option>
 <option value="Active">Active</option>
  <option value="New Lead">New Lead</option>
  <option value="Irrelevant">Irrelevant</option>
  <option value="Not Interested">Not Interested</option>
 </select>
<p ng-show="leadForm.status.$invalid && !leadForm.status.$pristine" class="help-block">Please select status </p>
 </div>

 
 <div class="form-group add-user col-md-6 col-sm-6" >
<select name="source" ng-change="lead_source(lead.source)" class="select2 form-control" ng-model="lead.source" ng-init="lead.source=l.source" name="source" aria-hidden="true" required>
<option value="">Select Lead Source</option>
<option value="Freelancer">Freelancer</option>
<option value="Upwork">Upwork</option>
<option value="Other">Other</option>
</select>

</div>

 
<div ng-if="l.source == 'Other'" class="form-group add-user col-md-6 col-sm-6" >
<input type="text" class="form-control" ng-model="lead.other_source" ng-init="lead.other_source=l.other_source" name="other_source" placeholder="lead source" > 
</div> 

<div  class="form-group add-user col-md-6 col-sm-6" >
<input type="text" class="form-control" ng-model="lead.technologies" ng-init="lead.technologies=l.technologies" name="technologies" placeholder="technologies" > 
</div> 
 
 
<!-- <div class="form-group add-user col-md-6 col-sm-6 padding-left" ng-class="{ 'has-error' : leadForm.accountNumber.$invalid && !leadForm.accountNumber.$pristine }">
<input type="number" class="form-control" ng-model="lead.accountNumber" name="accountNumber" placeholder="Account Number" minlenth="10" maxlenght="15" required> 
<p ng-show="leadForm.accountNumber.$invalid && !leadForm.accountNumber.$pristine" class="help-block">Please enter valid account number</p>
</div>
 -->
<div class="form-group add-user col-md-6 col-sm-6 padding-left" ng-class="{ 'has-error' : leadForm.clientType.$invalid && !leadForm.clientType.$pristine }">
<select name="clientType" class="select2 form-control" ng-model="lead.clientType" ng-init="lead.clientType=l.clientType"   name="clientType" aria-hidden="true" required>
 <option value="">Client Type</option>
  <option value="Individual">Individual</option>
  <option value="Introducery Broker">Introducery Broker</option>
  <option value="Corporate">Corporate</option>
   <option value="Affiliate">Affiliate</option>
 </select>
<p ng-show="leadForm.clientType.$invalid && !leadForm.clientType.$pristine" class="help-block">Please select status </p>
 </div>
<div class="form-actions left todo-form-actions col-md-6 col-sm-6 padding-left">
 <input class="btn btn-circle btn-md btn-primary" type="submit" ng-model="submit" value="Update Lead">

</div>
</div>
   </form>
</div>
  </div>








<div ng-hide="hide_leads " class="margin-top">

<div class="row">
<div class="col-md-12">
<div class="portlet-title" style="margin-bottom: 15px;">
<div class="caption">
<i class="icon-bar-chart font-green-sharp hide"></i>
<span class="caption-subject font-green-sharp bold leadtitle uppercase">Search Leads &nbsp;</span>
<input type="text"  class="form-control form-control-solid" ng-model="search" placeholder="search...">
</div>
</div>
<div class="margin-bottom15">
<a ng-click="pendingleads()" class="btn btn-circle btn-md btn-primary">Pending Leads</a> 
<a ng-click="closeleads()" class="btn btn-circle btn-md btn-primary" >Close Leads</a> 
</div>
<div class="portlet light portlet-fit bordered" ng-hide="pleads">
<div class="portlet-body">
<table class="table table-striped table-hover table-bordered" id="sample_editable_1">
<thead>
<tr>
<th> Full Name</th>
<th> Email </th>
<th> Contact </th>
<th> Status</th>
<th> Type</th>
<th>Date</th>
<th> View </th>
<th> Action </th>
</tr>
</thead>                            
<tbody>
<tr ng-repeat="lead in data1.slice(((currentPage-1)*itemsPerPage), ((currentPage)*itemsPerPage))|filter:search">
<td>{{lead.clientName}}</td>
<td>{{lead.email}} </td>
<td>{{lead.phone}} </td>
<td>{{lead.status}}</td>
<td>{{lead.clientType}}</td>
<td>{{lead.register_date}}</td>
<td>
  <a ng-if="lead.archive != 1" href="#/view_leads/{{lead.leadid}}"><button type="button" class="todo-username-btn btn btn-circle btn-default btn-sm" >&nbsp;View&nbsp;</button></a>
  <p ng-if="lead.archive == 1" class="text-danger">Archived Lead</p>
</td>
<td>
  <button ng-if="lead.archive != 1" type="button" ng-click="editlead(lead.leadid)" class="todo-username-btn btn btn-circle btn-default btn-sm" >&nbsp;Edit&nbsp;</button>
  <button  type="button" ng-click="delete_confirmation(lead.leadid)" class="todo-username-btn btn btn-circle btn-danger btn-sm" >&nbsp;Delete&nbsp;</button>
  <button ng-if="lead.archive != 1" type="button" ng-click="archive_lead(lead.leadid,1)" class="todo-username-btn btn btn-circle btn-danger btn-sm" >&nbsp;Archive&nbsp;</button>
  <button ng-if="lead.archive == 1" type="button" ng-click="archive_lead(lead.leadid,0)" class="todo-username-btn btn btn-circle btn-default btn-sm" >&nbsp;unarchive&nbsp;</button>

</span></td>
</tr>
</tbody>
</table>
<pagination total-items="totalItems" ng-model="currentPage" ng-change="pageChanged()" class="pagination-sm" items-per-page="itemsPerPage"></pagination>

</div>
</div>



<div class="portlet light portlet-fit bordered" ng-show="cleads">
<div class="portlet-body">
<table class="table table-striped table-hover table-bordered" id="sample_editable_1">
<thead>
<tr>
<th> Full Name </th>
<th> Email </th>
<th> Contact </th>
<th> Status</th>
 <th> View </th>
</tr>
</thead>                            
<tbody>
<tr ng-repeat="lead in data2.slice(((currentPage-1)*itemsPerPage), ((currentPage)*itemsPerPage))|filter:search">
<td>{{lead.clientName}}</td>
<td>{{lead.email}} </td>
<td>{{lead.phone}} </td>
<td>{{lead.status}}</td>
<td>
   <a href="#/close_leads/{{lead.leadid}}"><button type="button" class="todo-username-btn btn btn-circle btn-default btn-sm" >&nbsp;View&nbsp;</button></a></span>
   <button ng-if="lead.archive != 1" type="button" ng-click="archive_lead(lead.leadid,1)" class="todo-username-btn btn btn-circle btn-danger btn-sm" >&nbsp;Archive&nbsp;</button>
   <button ng-if="lead.archive == 1" type="button" ng-click="archive_lead(lead.leadid,0)" class="todo-username-btn btn btn-circle btn-default btn-sm" >&nbsp;unarchive&nbsp;</button>

</td>
</tr>
</tbody>
</table>
<pagination total-items="totalItems" ng-model="currentPage" ng-change="pageChanged()" class="pagination-sm" items-per-page="itemsPerPage"></pagination>

</div>
</div>



</div>
</div>
</div>

<div ng-show="show_lead_info" >
<div class="row" style="margin-bottom:30px;" >

<div class="col-md-5" style="margin-bottom:20px;">
<td><button type="button" style="background-color:#3598dc;color:white;" class="todo-username-btn btn btn-circle btn-default btn-sm" ng-click="showleads()">&nbsp;Show Leads&nbsp;</button></span></td>
</div>
<div class="col-md-12">
<div class="col-md-5">
<div class="tab-pane active" id="tab_3">
<div class="portlet box blue">
<div class="portlet-title">
<div class="caption">
<i class="fa fa-gift"></i>Leads Details </div>
<div class="tools">
<!-- <a href="javascript:;" class="collapse" data-original-title="" title=""> </a>
<a href="#portlet-config" data-toggle="modal" class="config" data-original-title="" title=""> </a>
<a href="javascript:;" class="reload" data-original-title="" title=""> </a> -->                                  
</div>
</div>
<div class="portlet-body form" ng-repeat="led in data.leadDetails">
<div class="form-body" >
<h2 class="margin-bottom-20"> Client Name : {{led.clientName}} </h2>
<h3 class="form-section">Contact Details</h3>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Email :</label>
<div class="col-md-3">
<p class="form-control-static"> {{led.email}} </p>
</div>
</div>
</div>

<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Alternative E-mail:</label>
<div class="col-md-9">
<p class="form-control-static"> {{led.altemail}} </p>
</div>
</div>
</div>
</div>
<div class="row">
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Contact No.:</label>
<div class="col-md-9">
<p class="form-control-static">{{led.phone}} </p>
</div>
</div>
</div>
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Alternative Contact no.:</label>
<div class="col-md-9">
<p class="form-control-static"> {{led.altphone}}</p>
</div>
</div>
</div>
</div>
<!--/row-->
<div class="row">
<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">City : </label>
<div class="col-md-9">
<p class="form-control-static">{{led.city}}</p>
</div>
</div>
</div>

<div class="col-md-12">
<div class="form-group">
<label class="control-label col-md-3">Country:</label>
<div class="col-md-9">
<p class="form-control-static"> {{led.country}}</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>	


<div class="col-md-7">


<!-- <div class="action-form" >
<form name="actionForm" ng-submit="addAction()" >
<div class="form-group" ng-class="{ 'has-error' : actionForm.status.$invalid && !actionForm.status.$pristine }">
<label>Status</label>
<div class="input-icon right">
<select class="form-control input-circle" id="status" name="status" ng-model="action.status" onchange="checkStatus()" required>
<option value="">Select Status</option>
 <option value="Reject">Reject</option>
 <option value="Not Intrested">Not Intrested</option>
 <option value="No Responce">No Responce</option>
 <option value="Call Back">Call Back</option>
 <option value="Intrested">Interested</option>
</select>
<p ng-show="actionForm.status.$invalid && !actionForm.status.$pristine" class="help-block">Please select status</p> 
</div>
</div>




<input type="text"  class="form-control"  ng-model="action.leadid" >

<div class="form-group" ng-class="{ 'has-error' : actionForm.action_dec.$invalid && !actionForm.action_dec.$pristine }">
<label>Description</label>
<div class="input-icon right">
  <textarea class="form-control" ng-model="action.action_des" name="action_dec" rows="3" required></textarea>
  <p ng-show="actionForm.action_dec.$invalid && !actionForm.action_dec.$pristine" class="help-block">Description is required</p>
</div>
</div>
<div id="reminder">
<div class="form-group">
<div class="col-md-6">
<div class="input-group date form_datetime">
 <input type="text" id="datepicker" ng-model="action.appointmentDate" name="appointmentDate" readonly class="form-control">
 <span class="input-group-btn">
   <button class="btn default date-set" type="button">
      <i class="fa fa-calendar"></i>
   </button>
 </span>
</div>
</div>
</div>
<div class="form-group">
<div class="col-md-6">
<div class="input-icon">
<input type="text" id="time" ng-model="action.appointmentTime" name="appointmentTime"   class="form-control" readonly> </div>
  </div>
</div>
</div>





<input class="btn btn-circle btn-md btn-default" type="submit" ng-model="$scope.action.submit" value="submit">
<button class="btn btn-circle cancelbtn btn-md btn-default" >Cancel</button>

</form>
</div> -->
<div class="action-form" >
<form name="actionForm" ng-submit="addAction()" >

<div class="form-group" ng-class="{ 'has-error' : actionForm.status.$invalid && !actionForm.status.$pristine }">
<div class="input-icon right">
<select class="form-control input-circle" id="status" name="status" ng-model="action.status" onchange="checkStatus()" required>
<option value="">Select Action</option>
 <option value="First Call">First Call </option>
 <option value="Follow-Up">Follow-Up </option>
 <option value="No-Reply">No-Reply </option>
 <option value="Email">Email</option>
 <option value="Not Reachable">Not Reachable</option>
 <option value="Switched Off">Switched Off</option>
 <option value="Wrong Details">Wrong Details</option>
</select>
<p ng-show="actionForm.status.$invalid && !actionForm.status.$pristine" class="help-block">Please select status</p> 
</div>
</div>
<!-- <div ng-repeat="lead in data.leadDetails">
<input type="text" class="form-control" ng-value="action.leadid" ng-model="action.leadid">
</div> -->
 
 <div class="form-group" ng-repeat="led in data.leadDetails" ng-init="action.lead_id=led.leadid">
 {{action.leadid}}
  <input class="form-control" type="text" name="lead_id" ng-model="action.lead_id" readonly="" />
</div>

<input type="text" ng-show="" class="form-control"  ng-model="action.action_date" >

<div class="form-group" ng-class="{ 'has-error' : actionForm.action_dec.$invalid && !actionForm.action_dec.$pristine }">
<label>Description</label>
<div class="input-icon right">
  <textarea class="form-control" ng-model="action.action_des" name="action_dec" rows="3"></textarea>
  <p ng-show="actionForm.action_dec.$invalid && !actionForm.action_dec.$pristine" class="help-block">Description is required</p>
</div>
</div>

<div class="form-group" ng-class="{ 'has-error' : actionForm.nextaction.$invalid && !actionForm.nextaction.$pristine }">
<div class="input-icon right">
<select class="form-control input-circle" id="nextaction" name="nextaction" ng-model="action.next_action" onchange="checkStatus()" required>
<option value="">Next Action</option>
 <option value="Call"> Call </option>
 <option value="Email">Email</option>
 <option value="Meeting">Meeting</option>
 <option value="Other">Other</option>
</select>
<p ng-show="actionForm.nextaction.$invalid && !actionForm.nextaction.$pristine" class="help-block">Please select status</p> 
</div>
</div>


<div class="form-group">
   <div class="col-md-6">
<div class="input-group date form_datetime">
 <input type="text" id="datetimepicker" ng-model="action.appointmentDate" name="appointmentDate" readonly class="form-control">
 <span class="input-group-btn">
   <button class="btn default date-set" type="button">
      <i class="fa fa-calendar"></i>
   </button>
 </span>
</div>
</div>
</div>


<div id="reminder">
  <div class="form-group">
   <div class="col-md-6">
<div class="input-group date form_datetime">
 <input type="text" id="datetimepicker" ng-model="action.appointmentDate" name="appointmentDate" readonly class="form-control">
 <span class="input-group-btn">
   <button class="btn default date-set" type="button">
      <i class="fa fa-calendar"></i>
   </button>
 </span>
</div>
</div>
</div>
<div class="form-group">
<div class="col-md-6">
<div class="input-icon">
<input type="text" id="time" ng-model="action.appointmentTime" name="appointmentTime"   class="form-control" readonly> </div>
  </div>
  
</div>
</div>





<input class="btn btn-circle btn-md btn-default" type="submit" ng-model="$scope.action.submit" value="submit">
<button class="btn btn-circle cancelbtn btn-md btn-default" >Cancel</button>

</form>
</div>

<div class="portlet-body" style="margin-top:30px;">
<table class="table table-striped table-bordered table-advance table-hover">
<thead>
<tr>
<th>Call No.</th>
<th><i class="fa fa-briefcase"></i> Status</th>
<th class="hidden-xs"><i class="fa fa-question"></i> Descrition </th>
<th><i class="fa fa-bookmark"></i> Time </th>
</tr>
</thead>
<tbody>
<tr ng-repeat="action in data.action">
<td><a href="javascript:;">{{action.actionid}}</a></td>
<td class="hidden-xs"> {{action.status}}<span class="label label-success label-sm"> Paid </span> </td>
<td> {{action.action_des}}</td>
<td>{{action.action_date}}</td>
</tr>
</tbody>
</table>
</div>

</div> 

</div>
</div>  
</div>


<div id="confModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
		 <h4 class="modal-title text-danger text-center" >Are you Sure to delete this lead ? it will delete all actions and reminders against this delete.</h4>
      </div>
	 <div class="modal-footer">
	    <button type="button" class="btn btn-info" ng-click="deletelead(ldid)">Yes</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">No</button>
     </div>
  </div>
</div>
</div>

<div id="sucModal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
		 <h4 class="modal-title text-success text-center" >{{msg}}</h4>
      </div>
	 <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Ok</button>
     </div>
  </div>
</div>
</div>

<style type="text/css">
#reminder{
display : none;
margin-bottom: 75px;
}
</style>


<script>
	$(function(){
	$('#example7').datepicker({
        format: 'yyyy/mm/dd'
    }).on('changeDate',  function (ev) {
        $(this).datepicker('hide');
    });
	
    }); 
</script>

<script>
function checkStatus() { 
var status = document.getElementById("status");
var selectedStatus = status.options[status.selectedIndex].value;
if(selectedStatus == "Call Back"){
jQuery("#reminder").css("display", "block");
}else{
jQuery("#reminder").css("display", "none");
}
}
</script>
<script>
$(function() {
$( "#datepicker" ).datepicker();
});



(function ($) {
    var methods = {
        getTime: function (elem) {
            var time = {};
            if (elem != undefined) {
                time = elem.data();
              if (time.h == null && elem.val().length) {
                  var arr = elem.val().split(":");
                  time.h = arr[0].trim();
                  time.m = arr[1].trim().split(" ")[0];
              }
            }
            return time;
        },
        setTime: function (time) {
            this.val(defaults.format(time));
        }
    };

  $.fn.timepicker = function (options) {

    var defaults = {
      format: function (h, m, t) {
        if (settings.isAMPM) {
          return h + " : " + m + " " + t;
        } else {
          return h + " : " + m;
        }
      },
      class_name: '',
      min_hour: 1,
      max_hour: 12,
      isAMPM: true,
      hours_step: '1',
      minutes_step: '1',
      overflow: false,
      hide_mobile_keyboard: false,
      onChange: null,
      beforeSetTime: null,
      start_time: null // { h: '', m: '', t: '' }
    };

    if (methods[options]) {
        return methods[options].apply(this, Array.prototype.slice.call(arguments, 1));
    }

    var settings = $.extend({}, defaults, options);

    var _this = $(this);

    _this.wrap("<div class='timePicker'>");
    var parent = _this.parents(".timePicker");

    var topBtn = "<div class='prev action-next'></div>";
    var bottomBtn = "<div class='next action-prev'></div>";

    var popup = $("<div class='timepicker_wrap " + settings.class_name + "'>" +
                  "<div class='arrow_top'></div>" +
                  "<div class='hours'>" + topBtn +
                  "<div class='hTime'>" +
                  "<input type='text' class='timepicker-input'" + 
                  (settings.use_mobile_keyboard ? "readonly" : "") + "></div>" +
                  bottomBtn +
                  "</div>" +
                  "<div class='minutes'>" + topBtn +
                  "<div class='mTime'>" +
                  "<input type='text' class='timepicker-input'" + 
                  (settings.use_mobile_keyboard ? "readonly" : "") + "></div>" +
                  bottomBtn +
                  "</div>");

    if (settings.isAMPM) {
      popup.append("<div class='amPm'>" + topBtn +
                   "<div class='tTime'><input type='text' class='timepicker-input'" + 
                   (settings.use_mobile_keyboard ? "readonly" : "") + " readonly></div>" +
                   bottomBtn +
                   "</div>");
    }

    parent.append(popup);

    var wrap = _this.next(".timepicker_wrap");
    var wrapChildren = wrap.find("div");
    var inputs = parent.find('input');

    inputs.keydown(function (keyevent) {
      var len = $(this).val().length;

      if ($.inArray(keyevent.keyCode, [46, 8, 9, 27, 13, 110, 190]) !== -1 ||
          (keyevent.keyCode == 65 && keyevent.ctrlKey === true) ||
          (keyevent.keyCode >= 35 && keyevent.keyCode <= 39)) {
        return;
      }

      if ((keyevent.shiftKey || (keyevent.keyCode < 48 || keyevent.keyCode > 57)) &&
          (keyevent.keyCode < 96 || keyevent.keyCode > 105) || len == 2) {
        keyevent.preventDefault();
      }
    });


    $(document).on("click", function (event) {
      if (!$(event.target).is(wrap) && wrap.css("display") == "block") {
        if (!$(event.target).is(_this)) {
          setValue(event, !inTimepicker($(event.target)));
        } else {
          wrap.css({
              "top": _this.position().top + _this.height()  + 10 + "px",
              "left": _this.position().left + "px"
          });
          openTimepicker();
        }
      }
    });

    _this.on('click', openTimepicker);

    inputs.on('focus', function () {
      var input = $(this);
      if (!input.is(_this)) {
        input.select();
      }
    });

    inputs.on('keydown', function (e) {
      var direction, input = $(this);

      if (e.which === 38) {
        direction = 'next';
      } else if (e.which === 40) {
        direction = 'prev';
      }

      if (input.closest('.timepicker_wrap .hours').length) {
        changeHour(null, direction);
      } else if (input.closest('.timepicker_wrap .minutes').length) {
        changeMinute(null, direction);
      } else if (input.closest('.timepicker_wrap .amPm').length && settings.show_meridian) {
        changeType(null, direction);
      }
    });

    inputs.on('blur', function () {
      setTimeout(function () {
        var focused_element = $(document.activeElement);
        if (focused_element.is(':input') && !inTimepicker(focused_element)) {
          setValue();
          closeTimepicker();
        }
      }, 0);
    });
    
    function inTimepicker(elem) {
      return $.contains(parent[0], elem[0]) || parent.is(elem);
    }
    
    function setFromPicker() {
      var hours = wrap.find(".hTime input").val();
      var minutes = wrap.find(".mTime input").val();
      var type = "";

      if (settings.isAMPM) {
        type = wrap.find(".tTime input").val();
      }

      if (hours.length !== 0 && minutes.length !== 0 && (!settings.isAMPM || type.length !== 0)) {

          if ($.isFunction(settings.beforeSetTime)) {
              time = settings.beforeSetTime.apply(_this,
                  [methods.getTime(_this), { h: hours, m: minutes, t: type }]);
              hours = time.h;
              minutes = time.m;
              type = time.t;
          }
        _this.data('h', hours);
        _this.data('m', minutes);

        if (settings.isAMPM) {
          _this.data('t', type);
          _this.val(settings.format(hours, minutes, type));
        } else {
          _this.val(settings.format(hours, minutes));
        }

        return true;
      }
      return false;
    }

    function setValue(event, close) {

      setFromPicker();

      if (settings.onChange !== null) {
        settings.onChange(_this[0]);
      }

      if (close) {
        closeTimepicker();
      }

    }

    function openTimepicker() {

      setDate(settings.start_time);
      wrap.fadeIn();

      var first = wrap.find('input:visible').first();
      first.focus();

      var first_exitHandler = function (e) {
        if (e.which === 9 && e.shiftKey) {
          first.off('keydown', first_exitHandler);
          var all_elements = $(':input:visible:not(.timepicker-input)');
          var index = all_elements.index(_this);
          var previous = all_elements.get(index - 1);
          previous.focus();
        }
      };
      first.on('keydown', first_exitHandler);
    }

    function closeTimepicker() {
      wrap.fadeOut();
    }

    function setDate(start_time) {
      var d, h, m, t;

      if (_this.data("h") != null && _this.data("m") != null && (_this.data('t') != null && settings.isAMPM == (_this.data('t').length != 0))) {
        h = Number(_this.data("h"));
        m = Number(_this.data("m"));
        if (settings.isAMPM) {
          t = _this.data("t");
        }
      }
      else if (start_time != null) {
        h = Number(start_time.h);
        m = Number(start_time.m);
        if (settings.isAMPM) {
          t = start_time.t;
        }
      }
      else {
        d = new Date();
        h = d.getHours();
        m = d.getMinutes();
        t = "AM";
        if (h > 12 && settings.isAMPM) {
          h -= 12;
          t = "PM";
        }
      }
      
      var realHours = 0;
      while (h > 59) {
          h -= 60;
          realHours++;
      } 
      
      if (realHours != 0)
          h = realHours;

      if (h < 10) {
        wrap.find(".hTime input").val("0" + h);
      } else {
        wrap.find(".hTime input").val(h);
      }
      if (m < 10) {
        wrap.find(".mTime input").val("0" + m);
      } else {
        wrap.find(".mTime input").val(m);
      }
      if (settings.isAMPM) {
        wrap.find(".tTime input").val(t);
      }
    }

    function changeHour(elem, direction) {
      var curHours = Number(wrap.find(".hours .hTime input").val());
      var min = Number(settings.min_hour);
      var max = Number(settings.max_hour);
      var step = Number(settings.hours_step);
      if ((elem && elem.hasClass('action-next')) || direction === 'next') {
        if (curHours + step > max) {
          var min_value = min;
          if (min_value < 10) {
            min_value = '0' + min_value;
          } else {
            min_value = String(min_value);
          }
          wrap.find(".hours .hTime input").val(min_value);
        } else {
          curHours += step;
          if (curHours < 10) {
            curHours = "0" + curHours;
          }
          wrap.find(".hours .hTime input").val(curHours);
        }
      } else if ((elem && elem.hasClass('action-prev')) || direction === 'prev') {
        if (curHours - step < min) {
          var max_value = max;
          if (max_value < 10) {
            max_value = '0' + max_value;
          } else {
            max_value = String(max_value);
          }
          wrap.find(".hours .hTime input").val(max_value);
        } else {
          curHours -= step;
          if (curHours < 10) {
            curHours = "0" + curHours;
          }
          wrap.find(".hours .hTime input").val(curHours);
        }
      }
    }

    function changeMinute(elem, direction) {
      var curMinute = Number(wrap.find(".minutes .mTime input").val());
      var min = 0;
      var max = 59;
      var step = Number(settings.minutes_step);
      if ((elem && elem.hasClass('action-next')) || direction === 'next') {
        if (curMinute + step > max) {
          wrap.find(".minutes .mTime input").val("00");
          if (settings.overflow_minutes) {
            changeHour(null, 'next');
          }
        } else {
          curMinute += step;
          if (curMinute < 10) {
            wrap.find(".minutes .mTime input").val("0" + curMinute);
          } else {
            wrap.find(".minutes .mTime input").val(curMinute);
          }
        }
      } else if ((elem && elem.hasClass('action-prev')) || direction === 'prev') {
        if (curMinute - step <= -1) {
          wrap.find(".minutes .mTime input").val(max + 1 - step);
          if (settings.overflow_minutes) {
            changeHour(null, 'prev');
          }
        } else {
          curMinute -= step;
          if (curMinute < 10) {
            wrap.find(".minutes .mTime input").val("0" + curMinute);
          } else {
            wrap.find(".minutes .mTime input").val(curMinute);
          }
        }
      }
    }

    function changeType(elem, direction) {
      var curType = wrap.find(".amPm .tTime input").val();
      if ((elem && elem.hasClass('action-next')) || direction === 'next') {
        if (curType == "AM") {
          wrap.find(".amPm .tTime input").val("PM");
        } else {
          wrap.find(".amPm .tTime input").val("AM");
        }
      } else if ((elem && elem.hasClass('action-prev')) || direction === 'prev') {
        if (curType == "AM") {
          wrap.find(".amPm .tTime input").val("PM");
        } else {
          wrap.find(".amPm .tTime input").val("AM");
        }
      }
    }

    var next = wrap.find(".action-next");
    var prev = wrap.find(".action-prev");
    $(prev).add(next).on("click", function () {
      var elem = $(this);
      if (elem.parent().attr("class") == "hours") {
        changeHour(elem);
      } else if (elem.parent().attr("class") == "minutes") {
        changeMinute(elem);
      } else {
        if (settings.isAMPM) {
          changeType(elem);
        }
      }
    });

    if (settings.start_time) {
      setDate(settings.start_time);
      setFromPicker();
    }
    return _this;
  };
} (jQuery));


$(function() {
   var tpOptions = {
            class_name: "pktTimePicker",
            overflow_minutes: true,
            start_time: { h: 12, m: '00', t: 'AM' },
            isAMPM: 1,
            beforeSetTime: function (oldTime, newTime) {
                var lastDefFrom = newTime.h * 60 + newTime.m;
                //setSessCookie("userStartTime", lastDefFrom);
                return newTime;
            }
        };
        
  $("#time").timepicker(tpOptions);
});



$(function(){
   
	
	$('#example6').datepicker({
        format: 'yyyy/mm/dd'
    }).on('changeDate',  function (ev) {
        $(this).datepicker('hide');
    });
	
	
	
	
          
        
    }); 

</script>

<style>
.hTime,
.mTime,
.tTime {
  width: 100%;
  text-align: center;
  margin: 10px 0;
}

.hours,
.minutes,
.amPm {
  color: #2d2e2e;
  float: none;
  font-size: 16px;
  font-family: inherit;
  width: 30px;
  font-weight: normal;
  display: inline-block;
  margin: 0px 3px;
}

.prev,
.next {
  cursor: pointer;
  border: 1px solid #ccc;
  margin: auto;
  background: url(http://joxi.ru/jnAy31oiWZ9dmZ.png) no-repeat;
  border-radius: 5px;
  background-size: 15px;
  padding: 13px;
  width: 5px;
}

.prev:hover,
.next:hover {
  background-color: #ccc;
}

.next {
  background-position: 50% 150%;
}

.prev {
  background-position: 50% -50%;
}

.time_picker {
  position: relative;
}

.timepicker_wrap {
  padding: 10px;
  border-radius: 5px;
  z-index: 998;
  display: none;
  box-shadow: 2px 2px 5px 0 rgba(50,50,50,0.35);
  border: 1px solid #ccc;
  float: left;
  position: absolute;
  top: 27px;
  left: 0;
  width: 130px;
  background: #FFFFFF;
}

.arrow_top {
  position: absolute;
  top: -10px;
  left: 20px;
  background: url(http://joxi.ru/vDr8eYjupNK9m6.png) no-repeat;
  width: 18px;
  height: 10px;
  z-index: 999;
}
input.timepicker-input {
  background: none repeat scroll 0 0 #FFFFFF;
  border: 1px solid #CCCCCC;
  float: none;
  margin: 0;
  text-align: center;
  width: 31px;
  border-radius: 0;
}
/* -------------------------------------------- */

</style>